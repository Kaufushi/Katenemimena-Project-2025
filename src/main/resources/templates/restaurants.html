<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Restaurants - StreetFoodGo</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/restaurants.css}">
    <link rel="stylesheet" th:href="@{/css/restaurant-form.css}">

</head>

<body>

<header class="navbar">
    <div class="container">
        <div class="logo">
            <a th:href="@{/}" style="text-decoration:none; color:inherit;">
                ğŸœ StreetFoodGo
            </a>
        </div>

        <div>
            <!-- LOGIN ÏŒÏ„Î±Î½ anonymous -->
            <a sec:authorize="isAnonymous()"
               th:href="@{/login}"
               class="btn btn-outline">
                Login
            </a>

            <!-- LOGOUT ÏŒÏ„Î±Î½ logged in -->
            <form sec:authorize="isAuthenticated()"
                  th:action="@{/logout}"
                  method="post"
                  style="display:inline;">
                <button type="submit" class="btn btn-outline">
                    Logout
                </button>
            </form>
        </div>
    </div>
</header>

<!-- OWNER ONLY BUTTON -->
<div class="owner-actions"
     sec:authorize="hasRole('OWNER')"
     style="text-align:center; margin: 1rem;">
    <a th:href="@{/restaurants/new}" class="btn btn-primary">
        â• Add Restaurant
    </a>
</div>

<h1 class="page-title">Discover Restaurants</h1>

<form class="filters" th:action="@{/restaurants}" method="get">
    <input type="text" name="search" placeholder="Search by name..." th:value="${search}">

    <select name="area">
        <option value="">All Areas</option>
        <option th:each="area : ${areas}"
                th:value="${area}"
                th:text="${area}"
                th:selected="${area == selectedArea}">
        </option>
    </select>

    <select name="cuisine">
        <option value="">All Cuisines</option>
        <option th:each="c : ${cuisines}"
                th:value="${c}"
                th:text="${c}"
                th:selected="${c == selectedCuisine}">
        </option>
    </select>

    <button class="btn" type="submit">Filter</button>
</form>

<div class="restaurant-grid">
    <div class="card" th:each="r : ${restaurants}">
        <img th:src="${r.imageUrl}" alt="Restaurant Image">

        <div class="card-content">
            <div class="card-title" th:text="${r.name}">Restaurant Name</div>
            <div class="card-info">
                ğŸ“ <span th:text="${r.area}">Area</span>
            </div>
            <div class="card-info">
                ğŸ½ï¸ <span th:text="${r.cuisine}">Cuisine</span>
            </div>

            <a th:href="@{/restaurants/{id}(id=${r.id})}" class="btn">
                View Menu
            </a>
        </div>
    </div>
</div>

</body>
</html>
